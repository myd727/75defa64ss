<!DOCTYPE html>
<html lang="ko">
<head>
<meta name="robots" content="noindex, nofollow">
<meta name="googlebot" content="noindex, nofollow">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BIT RESULT</title>

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
  }

  h1 {
    text-align: center;
    font-size: 22px;
    margin-bottom: 10px;
  }

  /* ===== 상단 언어 버튼 ===== */
  .top-bar {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 10px;
    gap: 5px;
  }

  .lang-btn {
    padding: 5px 10px;
    font-size: 13px;
    font-weight: bold;
    border: 1px solid #333;
    background: #f2f2f2;
    cursor: pointer;
  }

  .lang-btn.active {
    background: #333;
    color: #fff;
  }

  .input-wrap {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }

  label {
    font-weight: bold;
    white-space: nowrap;
  }

  input {
    width: 200px;
    padding: 8px;
    font-size: 16px;
    text-align: center;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    margin-bottom: 15px;
  }

  th, td {
    border: 1px solid #333;
    padding: 10px;
  }

  th {
    background: #f2f2f2;
    text-align: center;
  }

  .left { width: 50%; }
  .right { width: 50%; text-align: center; }

  .fail {
    background: #ffd6d6;
    color: #c40000;
    font-weight: bold;
  }

  .ok {
    background: #dff5d8;
    color: #0a7a0a;
    font-weight: bold;
  }

  .bit-code {
    font-size: 16px;
    font-weight: bold;
  }

  .bit-name {
    font-size: 13px;
    margin-top: 4px;
  }

  .btn-wrap {
    text-align: center;
  }

  button {
    padding: 8px 16px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
  }
</style>
</head>

<body>

<div class="top-bar">
  <button class="lang-btn active" id="btnKo">한글</button>
  <button class="lang-btn" id="btnEn">ENGLISH</button>
</div>

<h1 id="title">XMTR BIT 결과 판독기</h1>

<div class="input-wrap">
  <label id="codeLabel">코드입력</label>
  <input id="codeInput" type="text" placeholder="예: 0x77d6 또는 77d6">
</div>

<table id="resultTable">
  <tr>
    <th class="left" id="thBit">비트내용</th>
    <th class="right" id="thResult">점검결과</th>
  </tr>
</table>

<div class="btn-wrap">
  <button id="toggleBtn" style="display:none;">전체 결과 펼치기</button>
</div>

<script>

const pw = prompt("사무실 전화번호 뒤 4자리 937-0000 / 김복성(KBS)");
  if (pw !== "4775") {
    document.body.innerHTML = "DENY";
  }
  
/* ===== 언어팩 ===== */
const langPack = {
  ko: {
    title: "XMTR BIT 결과 판독기",
    bit: "비트내용",
    result: "점검결과",
    all: "전체 결과 펼치기",
    pass: "정상",
    fail: "결함",
    code: "코드입력"
  },
  en: {
    title: "XMTR BIT RESULT",
    bit: "BIT",
    result: "RESULT",
    all: "ALL RESULT",
    pass: "PASS",
    fail: "FAIL",
    code: "CODE"
  }
};

let lang = "ko";

/* ===== BIT 정의 ===== */
const bitMap = [
  { code: "XMGO", name: "Transmit Go" },
  { code: "RFIP", name: "RF Input Power" },
  { code: "CUFL", name: "Coolant Flow" },
  { code: "TEMP", name: "Temperature" },
  { code: "XMPL", name: "Transmit Power Level" },
  { code: "PWRR", name: "Pulse Width / Pulse Rep Rate" },
  { code: "TFPS", name: "TWT Filament Power" },
  { code: "VSWR", name: "Voltage Standing Wave Ratio" },
  { code: "DUCY", name: "Duty Cycle" },
  { code: "IONC", name: "Ion Pump Current" },
  { code: "HVPS", name: "High Voltage Power Supply" },
  { code: "TBOC", name: "TWT Body Current" },
  { code: "TGBV", name: "TWT Grid Bias Voltage" },
  { code: "LVPS", name: "Low Voltage Power Supply" },
  { code: "LOCK", name: "Interlocks" },
  { code: "XMRY", name: "Transmit Ready" }
];

const input = document.getElementById("codeInput");
const table = document.getElementById("resultTable");
const btn = document.getElementById("toggleBtn");

const btnKo = document.getElementById("btnKo");
const btnEn = document.getElementById("btnEn");

let lastBinary = "";

/* ===== 언어 버튼 ===== */
btnKo.onclick = () => setLanguage("ko");
btnEn.onclick = () => setLanguage("en");

function setLanguage(l) {
  lang = l;
  btnKo.classList.toggle("active", l === "ko");
  btnEn.classList.toggle("active", l === "en");
  applyLanguage();
  if (lastBinary) showFailOnly();
}

/* ===== 입력 처리 ===== */
input.addEventListener("input", () => {
  let hex = input.value.trim().toLowerCase();
  if (hex.startsWith("0x")) hex = hex.slice(2);

  if (!/^[0-9a-f]{4}$/.test(hex)) {
    clearResults();
    btn.style.display = "none";
    return;
  }

  lastBinary = parseInt(hex, 16).toString(2).padStart(16, "0");
  showFailOnly();
  btn.style.display = "inline-block";
});

btn.addEventListener("click", showAllResults);

/* ===== 결과 ===== */
function showFailOnly() {
  clearResults();
  lastBinary.split("").forEach((bit, i) => {
    if (bit === "0") appendRow(i, langPack[lang].fail, "fail");
  });
}

function showAllResults() {
  clearResults();
  lastBinary.split("").forEach((bit, i) => {
    appendRow(
      i,
      bit === "0" ? langPack[lang].fail : langPack[lang].pass,
      bit === "0" ? "fail" : "ok"
    );
  });
}

function appendRow(i, text, cls) {
  const info = bitMap[i];
  const row = document.createElement("tr");
  row.innerHTML = `
    <td class="left">
      <div class="bit-code">${info.code}</div>
      <div class="bit-name">${info.name}</div>
    </td>
    <td class="right ${cls}">${text}</td>
  `;
  table.appendChild(row);
}

function clearResults() {
  table.querySelectorAll("tr:not(:first-child)").forEach(tr => tr.remove());
}

/* ===== UI 언어 ===== */
function applyLanguage() {
  document.getElementById("title").textContent = langPack[lang].title;
  document.getElementById("thBit").textContent = langPack[lang].bit;
  document.getElementById("thResult").textContent = langPack[lang].result;
  document.getElementById("toggleBtn").textContent = langPack[lang].all;
  document.getElementById("codeLabel").textContent = langPack[lang].code;
}

applyLanguage();
</script>

</body>

</html>

